<nav class="main-navigation">
  <div class="nav-container">

    <!-- Logo/Brand -->
    <div class="nav-brand">
      <a routerLink="/patient/dashboard" class="brand-link">
        <img src="assets/images/healthease-logo.png" alt="HealthEase" class="brand-logo">
        <span class="brand-text">HealthEase</span>
      </a>
    </div>

    <!-- Navigation Menu -->
    <div class="nav-menu" [class.active]="mobileMenuOpen">

      <!-- Main Navigation Links -->
      <div class="nav-links">
        <a routerLink="/patient/dashboard"
           routerLinkActive="active"
           class="nav-link">
          <i class="fas fa-tachometer-alt"></i>
          <span>Dashboard</span>
        </a>

        <a routerLink="/patient/appointments"
           routerLinkActive="active"
           class="nav-link">
          <i class="fas fa-calendar-check"></i>
          <span>Appointments</span>
        </a>

        <a routerLink="/patient/doctors"
           routerLinkActive="active"
           class="nav-link">
          <i class="fas fa-user-md"></i>
          <span>Find Doctors</span>
        </a>

        <a routerLink="/patient/medical-records"
           routerLinkActive="active"
           class="nav-link">
          <i class="fas fa-file-medical"></i>
          <span>Medical Records</span>
        </a>

        <a routerLink="/patient/prescriptions"
           routerLinkActive="active"
           class="nav-link">
          <i class="fas fa-pills"></i>
          <span>Prescriptions</span>
        </a>
      </div>

      <!-- User Profile Section -->
      <div class="nav-user-section">

        <!-- Profile Button - NEW -->
        <a routerLink="/patient/profile"
           routerLinkActive="active"
           class="nav-profile-btn"
           title="View My Profile">
          <div class="profile-btn-content">
            <div class="profile-avatar" *ngIf="currentUser">
              <img *ngIf="currentUser.profilePicture; else defaultProfileAvatar"
                   [src]="currentUser.profilePicture"
                   [alt]="currentUser.firstName + ' ' + currentUser.lastName">
              <ng-template #defaultProfileAvatar>
                <span class="avatar-initials">
                  {{currentUser.firstName?.charAt(0)}}{{currentUser.lastName?.charAt(0)}}
                </span>
              </ng-template>
            </div>
            <div class="profile-info">
              <span class="profile-name">{{currentUser?.firstName}} {{currentUser?.lastName}}</span>
              <span class="profile-label">My Profile</span>
            </div>
            <i class="fas fa-user profile-icon"></i>
          </div>
        </a>

        <!-- Notifications -->
        <div class="nav-notifications" (click)="toggleNotifications()">
          <i class="fas fa-bell notification-icon"></i>
          <span class="notification-badge" *ngIf="unreadNotifications > 0">
            {{unreadNotifications}}
          </span>
        </div>

        <!-- User Menu Dropdown -->
        <div class="user-menu-dropdown" [class.active]="userMenuOpen">
          <button class="user-menu-trigger" (click)="toggleUserMenu()">
            <div class="user-avatar">
              <img *ngIf="currentUser?.profilePicture; else defaultUserAvatar"
                   [src]="currentUser.profilePicture"
                   [alt]="currentUser.firstName">
              <ng-template #defaultUserAvatar>
                <span class="avatar-initials">
                  {{currentUser?.firstName?.charAt(0)}}{{currentUser?.lastName?.charAt(0)}}
                </span>
              </ng-template>
            </div>
            <i class="fas fa-chevron-down dropdown-arrow"></i>
          </button>

          <!-- Dropdown Menu -->
          <div class="dropdown-menu" *ngIf="userMenuOpen">
            <div class="dropdown-header">
              <div class="user-info">
                <h4>{{currentUser?.firstName}} {{currentUser?.lastName}}</h4>
                <p>{{currentUser?.email}}</p>
              </div>
            </div>

            <div class="dropdown-divider"></div>

            <div class="dropdown-items">
              <a routerLink="/patient/profile" class="dropdown-item" (click)="closeUserMenu()">
                <i class="fas fa-user-circle"></i>
                <span>View Profile</span>
              </a>

              <a routerLink="/patient/profile-setup" class="dropdown-item" (click)="closeUserMenu()">
                <i class="fas fa-user-edit"></i>
                <span>Edit Profile</span>
              </a>

              <a routerLink="/patient/settings" class="dropdown-item" (click)="closeUserMenu()">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
              </a>

              <div class="dropdown-divider"></div>

              <button class="dropdown-item left-logout-btn" (click)="logout()">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" (click)="toggleMobileMenu()">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
  </div>
</nav>
